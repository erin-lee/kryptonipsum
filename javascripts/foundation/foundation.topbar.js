/*jslint unparam: true, browser: true, indent: 2 */
(function(e,t,n,r){"use strict";Foundation.libs.topbar={name:"topbar",version:"4.0.0",settings:{index:0,stickyClass:"sticky",init:!1},init:function(n,r,i){this.scope=n||this.scope,typeof r=="object"&&e.extend(!0,this.settings,r);if(typeof r!="string"){this.settings.$w=e(t),this.settings.$topbar=e("nav.top-bar"),this.settings.$section=this.settings.$topbar.find("section"),this.settings.$titlebar=this.settings.$topbar.children("ul").first();var s=e("<div class='top-bar-js-breakpoint'/>").appendTo("body");return this.settings.breakPoint=s.width(),s.remove(),this.settings.init||(this.events(),this.assemble()),this.settings.height||this.largestUL(),this.settings.$topbar.parent().hasClass("fixed")&&e("body").css("padding-top",this.outerHeight(this.settings.$topbar)),this.settings.init}return this[r].call(this,i)},events:function(){e(this.scope).on("click.fndtn.topbar",".top-bar .toggle-topbar",function(e){e.preventDefault(),this.breakpoint()&&(this.settings.$topbar.toggleClass("expanded"),this.settings.$topbar.css("min-height","")),this.settings.$topbar.hasClass("expanded")||(this.settings.$section.css({left:"0%"}),this.settings.$section.find(">.name").css({left:"100%"}),this.settings.$section.find("li.moved").removeClass("moved"),this.settings.index=0)}.bind(this)).on("click.fndtn.topbar",".top-bar .has-dropdown>a",function(t){var n=Foundation.libs.topbar;(Modernizr.touch||n.breakpoint())&&t.preventDefault();if(n.breakpoint()){var r=e(this),i=r.closest("li");n.settings.index+=1,i.addClass("moved"),n.settings.$section.css({left:-(100*n.settings.index)+"%"}),n.settings.$section.find(">.name").css({left:100*n.settings.index+"%"}),r.siblings("ul").height(n.settings.height+n.outerHeight(n.settings.$titlebar,!0)),n.settings.$topbar.css("min-height",n.settings.height+n.outerHeight(n.settings.$titlebar,!0)*2)}}),e(t).on("resize.fndtn.topbar",function(){this.breakpoint()||this.settings.$topbar.css("min-height","")}.bind(this)),e(this.scope).on("click.fndtn",".top-bar .has-dropdown .back",function(t){t.preventDefault();var n=e(this),r=Foundation.libs.topbar,i=n.closest("li.moved"),s=i.parent();r.settings.index-=1,r.settings.$section.css({left:-(100*r.settings.index)+"%"}),r.settings.$section.find(">.name").css({left:100*r.settings.index+"%"}),r.settings.index===0&&r.settings.$topbar.css("min-height",0),setTimeout(function(){i.removeClass("moved")},300)})},breakpoint:function(){return this.settings.$w.width()<=this.settings.breakPoint||e("html").hasClass("lt-ie9")},assemble:function(){this.settings.$section.detach(),this.settings.$section.find(".has-dropdown>a").each(function(){var t=e(this),n=t.siblings(".dropdown"),r=e('<li class="title back js-generated"><h5><a href="#">&laquo; Back</a></h5></li>');n.prepend(r)}),this.settings.$section.appendTo(this.settings.$topbar),this.sticky()},largestUL:function(){var t=this.settings.$topbar.find("section ul ul"),n=t.first(),r=0,i=this;t.each(function(){e(this).children("li").length>n.children("li").length&&(n=e(this))}),n.children("li").each(function(){r+=i.outerHeight(e(this),!0)}),this.settings.height=r},sticky:function(){var n="."+this.stickyClass;if(e(n).length>0){var r=e(n).length?e(n).offset().top:0,i=e(t),s=this.outerHeight(e("nav.top-bar"))+20;i.scroll(function(){i.scrollTop()>=r?(e(n).addClass("fixed"),e("body").css("padding-top",s)):i.scrollTop()<r&&(e(n).removeClass("fixed"),e("body").css("padding-top","0"))})}},off:function(){e(this.scope).off(".fndtn.topbar"),e(t).off(".fndtn.topbar")}}})(Foundation.zj,this,this.document);